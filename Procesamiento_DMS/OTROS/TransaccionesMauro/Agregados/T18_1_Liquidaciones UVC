[{"$match":{"$expr":{"$gt":["$fec_valor",{"$toDate":"@fechaProceso"}]}}},{"$addFields":{"fechaProceso":{"$dateFromParts":{"year":{"$year":"$fec_valor"},"month":{"$add":[{"$month":"$fec_valor"},1]},"day":{"$subtract":[{"$dayOfMonth":{"$dateFromParts":{"year":{"$year":"$fec_valor"},"month":{"$add":[{"$month":"$fec_valor"},1]},"day":1}}},1]},"hour":0,"minute":0,"second":0,"millisecond":0}},"rifCedula":{"$trim":{"input":{"$substr":["$ced_identidad",1,{"$strLenCP":"$ced_identidad"}]},"chars":" "}},"primeraLetraRif":{"$substr":["$ced_identidad",0,1]},"fecha_valor":"$fec_valor"}},{"$addFields":{"rifCedula":{"$ltrim":{"input":"$rifCedula","chars":"0"}},"fec_valor":"$$REMOVE"}},{"$addFields":{"longitudIdentificacionSinCero":{"$strLenCP":"$rifCedula"}}},{"$addFields":{"rifCedula":{"$switch":{"branches":[{"case":{"$gte":["$longitudIdentificacionSinCero",8]},"then":"$rifCedula"},{"case":{"$eq":["$longitudIdentificacionSinCero",7]},"then":{"$concat":["0","$rifCedula"]}},{"case":{"$eq":["$longitudIdentificacionSinCero",6]},"then":{"$concat":["00","$rifCedula"]}}],"default":{"$concat":["000","$rifCedula"]}}}}},{"$addFields":{"rifCedula":{"$concat":["$primeraLetraRif","$rifCedula"]}}},{"$project":{"primeraLetraRif":0,"longitudIdentificacionSinCero":0,"ced_identidad":0,"_id":0}},{"$merge":{"into":"sidis_activos_liq_uvc","on":["fecha_valor","rifCedula","cta_cre"]}}]