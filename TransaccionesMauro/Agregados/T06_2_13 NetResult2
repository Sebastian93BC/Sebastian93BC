[{"$match":{"$expr":{"$eq":["$fechaProceso",{"$toDate":"@fechaProceso"}]}}},{"$addFields":{"resultNetResult2":{"$round":[{"$divide":[{"$multiply":["$netResult2",100]},"$globalNetResult2"]},5]}}},{"$lookup":{"from":"sidis_tasaconversion","localField":"fechaProceso","foreignField":"Fecha","as":"result"}},{"$addFields":{"tasaDolar":{"$arrayElemAt":["$result.Tasa_DOL",0]},"tasaEuro":{"$arrayElemAt":["$result.Tasa_EUR",0]},"factorConversion":{"$arrayElemAt":["$result.Conversion",0]}}},{"$sort":{"resultNetResult2":-1}},{"$project":{"_id":0,"fechaProceso":1,"name":1,"resultNetResult2":1,"tasaDolar":1,"tasaEuro":1,"factorConversion":1,"netResult2":1,"globalNetResult2":1,"globalNetResult2USD":1}},{"$group":{"_id":{"fechaProceso":"$fechaProceso"},"netResult2":{"$push":{"name":"$name","prctValue":"$resultNetResult2","amountBsValue":"$netResult2","amountUsdValue":{"$divide":["$netResult2","$tasaDolar"]},"globalValue":"$globalNetResult2USD"}}}},{"$addFields":{"fechaProceso":"$_id.fechaProceso","_id":"$$REMOVE"}},{"$merge":{"into":"Financialstatementdashboard","on":"fechaProceso"}}]